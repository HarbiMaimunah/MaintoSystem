@model BeneficiaryPortal.Models.BeneficiaryRegistration
@{
    ViewData["Title"] = "Sign up";
}

<script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
<script>
    $(document).ready(function () {
        $("#BuildingNumber").change(function () {
            $.get("http://localhost:16982/api/BeneficiaryEntry/ListFloors", { buildingID: $("#BuildingNumber").val() }, function (data) {
                $("#FloorNumber").empty();
                $.each(data, function (index, row) {
                    $("#FloorNumber").append("<option value='"+ row.Id +"'>"+ row.Number +"</option>")
                });
            });
        });
    });
</script>

<h1>Sign Up</h1>
<p class="text-danger">@TempData["SignupError"]</p>
@using (Html.BeginForm("Register", "Beneficiary", FormMethod.Post))
{

    @Html.AntiForgeryToken()

    <div class="form-horizontal">
        <div class="form-group">
            @Html.LabelFor(model => model.Name, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-sm-3">
                @Html.EditorFor(model => model.Name, new { htmlAttributes = new { @class = "form-control" } })
            </div>
        </div>
        <br />
        <div class="form-group">
            @Html.LabelFor(model => model.Phone, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-sm-3">
                @Html.EditorFor(model => model.Phone, new { htmlAttributes = new { @class = "form-control" } })
            </div>
        </div>
        <br />
        <div class="form-group">
            <label class="control-label col-md-2">Building</label>
            <div class="col-sm-3">
                @if (ViewBag.BuildingsList != null)
                {
                    @Html.DropDownListFor(model => model.BuildingNumber, ViewBag.BuildingsList as SelectList, "-- Select Building --", htmlAttributes: new { @id = "BuildingNumber" })
                }
            </div>
        </div>
        <br />
        <div class="form-group">
            <label class="control-label col-md-2">Floor</label>
            <div class="col-sm-3">
                @Html.DropDownListFor(model => model.FloorNumber, new SelectList(" "), "-- Select Floor --", htmlAttributes: new { @id = "FloorNumber" })
            </div>
        </div>
        <br />
        <div class="form-group">
            @Html.LabelFor(model => model.Email, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-sm-3">
                @Html.EditorFor(model => model.Email, new { htmlAttributes = new { @class = "form-control" } })
            </div>
        </div>
        <br />
        <div class="form-group">
            @Html.LabelFor(model => model.Password, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-sm-3">
                @Html.EditorFor(model => model.Password, new { htmlAttributes = new { @class = "form-control" } })
            </div>
        </div>
        <div class="form-group">
            <div class="col-md-offset-2 col-md-10">
                <input type="submit" value="Sign up" class="btn btn-primary" />
            </div>
        </div>
    </div>

}